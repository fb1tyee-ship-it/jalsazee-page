<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Player</title>
<link rel="stylesheet" href="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.css">
<script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f7f7f7;display:flex;flex-direction:column;align-items:center}
header{
    background:#ff0000;
    color:white;
    padding:12px;
    text-align:center;
    font-size:20px;
    width:100%;
    position:sticky;
    top:0;
    display:flex;
    align-items:center;
    justify-content:center;
}
header button{
    position:absolute;
    left:10px;
    background:white;
    color:#ff0000;
    border:none;
    padding:6px 12px;
    font-size:14px;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}
header button:hover{background:#ffe5e5}
.player-container{display:flex;flex-direction:column;max-width:600px;width:100%;padding:10px}
video{width:100%;border-radius:10px}
#video-title{font-size:14px; margin:5px 0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
#video-desc{font-size:12px; color:#555; margin:2px 0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
</style>
</head>
<body>
<header>
  <button onclick="goBack()">⬅ Back</button>
  <span>Shajazada Bhai Videos</span>
</header>
<div class="player-container">
  <video id="video-player" controls></video>
  <h3 id="video-title" title=""></h3>
  <p id="video-desc" title=""></p>
</div>
<script>
function goBack(){
    window.location.href = "index.html";
}

window.onload = function(){
    const params = new URLSearchParams(window.location.search);
    const url = params.get('url');
    const title = params.get('title');
    const desc = params.get('desc');

    if(url){
        const player = document.getElementById('video-player');
        const decodedUrl = decodeURIComponent(url);
        player.src = decodedUrl;

        const titleEl = document.getElementById('video-title');
        const descEl = document.getElementById('video-desc');

        const decodedTitle = decodeURIComponent(title || '');
        const decodedDesc = decodeURIComponent(desc || '');

        titleEl.textContent = decodedTitle;
        descEl.textContent = decodedDesc;

        titleEl.title = decodedTitle;
        descEl.title = decodedDesc;

        player.load();

        // Fluid Player Mid-roll after 1 min
        player.addEventListener('loadedmetadata', function() {
            var fluid = fluidPlayer('video-player', {
                vastOptions: {
                    adList: [
                        {
                            roll: 'midRoll',
                            vastTag: 'https://s.magsrv.com/v1/vast.php?idzone=5707142',
                            timer: 60, // 1 minute after video starts
                            adText: 'Advertisement - Please wait',
                            adTextPosition: 'top left',
                            skipButtonCaption: 'Skip Ad',
                            skipButtonPosition: 'bottom right',
                            onAdComplete: function(){ console.log("✅ Ad finished, continuing main video"); },
                            onAdSkip: function(){ console.log("⚠️ Ad skipped, continuing main video"); }
                        }
                    ]
                }
            });
        });

        // Play video with user interaction to bypass autoplay block
        const playPromise = player.play();
        if(playPromise !== undefined){
            playPromise.catch(error => { 
                console.log('⚠️ Autoplay blocked. Waiting for user interaction.');
                player.addEventListener('click', function(){ player.play(); }, { once: true });
            });
        }
    }
};
</script>
</body>
</html>
